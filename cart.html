<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="css/mystyle-main.css"/>
    <title>Cart</title>
</head>
<body>
    <header>
        <table class="header" border="0">
            <tr>
                <td class="logo"><a href="index.html"><img src="images/e-store-2.png"  alt="e-store"></a></td>
                <td>
                    <div class="search">
                        <input type="text" placeholder='search...'>
                        <button type="submit"><img src="images/search-solid.svg" alt="search"></button>
                    </div>
                </td>
               <td>
                <div style="padding-left: 30px; text-align: center; position: relative;">
                    <a href="cart.html">
                        <img src="images/shopping-cart-3.png" alt="CART" style="width: 30px; height: 30px;"><br>
                        Cart <div id="cart-count" class="cart-count" style="display: none;"><script>totalProductsInCart</script></div>
                    </a>
                </div>
                </td>
                <td>
                    <div style="padding-left: 30px; padding-top: 0px; text-align: center;"> 
                        <a href="wishlist.html"><img src="images/like-2.png" alt="WishList" ><br>WishList</a>
                    </div>
                </td>
                <td style="text-align: right; padding-right: 30px; position: relative; left: 770px;">
                    <div style="display: flex; align-items: center; justify-content: flex-end; position: relative; width: 100%;">
                        <a href="#" id="avatar-link" style="margin-right: 10px;">
                            <img src="images/profile.png" alt="my profile" style="height:50px; width:50px;">
                        </a>
                        <div class="signout" style="display: none; position: absolute; top: 60px; left: -10px;width: 120px;">
                            <button id="signout-button" style="display: flex; align-items: center; background-color: rgb(4, 120, 221); border: none; color: white; padding: 5px; border-radius: 5px;">
                                <h3 style="margin: 0;">Sign Out</h3>
                                <img src="images/logout.png" alt="sign out" style="width: 30px; height: 30px; margin-left: 5px;">
                            </button>
                        </div>
                    </div>
                </td>
            </tr>
        </table>
    </header>
    
    <div><h2>Shopping Cart</h2></div>
    
    <div class="cart">
        <div class="cart-container">
            <div id="cart-items"></div>
            <div id="cart-summary">
                <p style="font-size: 25px;"><b>Order Summary</b></p>
                <br>
                <div class="total-items">
                    <h3>Total Items</h3>
                    <h3 id="total-items-count">0</h3>
                </div>
                <br>
                <div class="shipping-fee">
                    <h3>Shipping Fee</h3>
                    <h3 style="color: green;">Free</h3>
                </div>
                <br>
                <div class="total">
                    <h3>Total Price</h3><h3><span id="total-price">$0.00</span></h3>
                </div>
                <div id="pay-div"><button id="pay-button" onclick="location.href='payment.html'">Proceed to Pay</button></div>
            </div>
        </div>
    </div>
   
    <footer class="footer">
        <table border="0">
            <tr>
               <div>
                <td class="logo-f"><img src="images/e-store-2.png" height="150px" width="150px" alt="e-store"></td>
               </div>
                <div class="footer-element">
                    <td><h3>Find Us</h3></td>
                <td>
                    <div class="social-media"><img src="images/social-media/twitter (1).png" alt="X"></div>
                </td>
                <td>
                    <div class="social-media"><img src="images/social-media/facebook (1).png" alt="facebook"></div>
                </td>
                <td>
                    <div class="social-media"><img src="images/social-media/tik-tok (1).png" alt="tiktok"></div>
                </td>
                <td>
                    <div class="social-media"><img src="images/social-media/instagram (1).png" alt="instagram"></div>
                </td>
                </div>
                <td><div  class="footer-element" style="width:100px;">
                    <td><h3>E-mail: </h3></td>
                    <td><a href="mailto:myEmail@example.com" style="text-decoration: none; color:#FFCC00;"><h3>myEmail@example.com</h3></a></td>
                </div></td>
               
                <td><div  class="footer-element" style="width:100px;">
                    <td><h3>Call Center: </h3></td>
                    <td><h3 style="color:#FFCC00;">8001207669</h3></td>
                </div></td>
               
                <td><div  class="footer-element" style="width:100px;">
                    <td><h3 style="color:#FFCC00;">About Us</h3></td>
                </div></td>
                
            </tr>
        </table>
    </footer>

    <script>
        const cartProducts = [
            { id: 1, oldPrice: 100, newPrice: 80, imageUrl: 'https://via.placeholder.com/150?text=Product+1', discount: 20, quantity: 1 },
            { id: 2, oldPrice: 150, newPrice: 112.50, imageUrl: 'https://via.placeholder.com/150?text=Product+2', discount: 25, quantity: 1 },
        ];

        function displayProducts(productArray) {
            const productContainer = document.getElementById('cart-items');
            productContainer.innerHTML = ''; // Clear previous products
            let total = 0;
            let totalItems = 0; // Variable to hold total items count

            productArray.forEach(product => {
                total += product.newPrice * product.quantity;
                totalItems += product.quantity; // Increment total items
                
                const productCard = document.createElement('div');
                productCard.className = 'product-card';
                productCard.innerHTML = `
                    <img src="${product.imageUrl}" alt="Product ${product.id}" class="product-image" style="width: 150px;">
                    <div class="cart-product-details">
                        <div class="product-name"><h3>Product ${product.id}</h3></div>
                        <div id="product-price">
                            <p class="old-price">${product.oldPrice.toFixed(2)}</p>
                            <p class="new-price">${product.newPrice.toFixed(2)}</p>
                            <div class="product-quantity">
                                <button class="remove" onclick="removeFromCart(${product.id})"><img src="images/delete.png" alt="Remove" style="width: 15px; height: 15px;"></button>
                                <button class="decrease" onclick="decreaseQuantity(${product.id})" id="decrease-${product.id}" ${product.quantity === 1 ? 'disabled' : ''}>-</button>
                                <span id="quantity-${product.id}">${product.quantity}</span>
                                <button class="increase" onclick="increaseQuantity(${product.id})">+</button>
                            </div>
                        </div>
                    </div>
                `;
                productContainer.appendChild(productCard);
            });

            document.getElementById('total-price').textContent = `$${total.toFixed(2)}`;
            document.getElementById('total-items-count').textContent = totalItems; // Update the total items count
        }

        function increaseQuantity(productId) {
            const product = cartProducts.find(item => item.id === productId);
            if (product) {
                product.quantity++;
                displayProducts(cartProducts); // Refresh the cart display
            }
        }

        function decreaseQuantity(productId) {
            const product = cartProducts.find(item => item.id === productId);
            if (product && product.quantity > 1) {
                product.quantity--;
                displayProducts(cartProducts); // Refresh the cart display
            }
        }

        function removeFromCart(productId) {
            const index = cartProducts.findIndex(item => item.id === productId);
            if (index !== -1) {
                cartProducts.splice(index, 1); // Remove the product from the array
                displayProducts(cartProducts); // Refresh the cart display
            }
        }

        // Initialize by displaying all products
        displayProducts(cartProducts);

        document.getElementById('avatar-link').addEventListener('click', function(event) {
    event.preventDefault(); // Prevent the default link behavior
    const signoutDiv = document.querySelector('.signout');
    signoutDiv.style.display = signoutDiv.style.display === 'none' ? 'flex' : 'none'; // Toggle visibility
});

// Sign out functionality
document.getElementById('signout-button').addEventListener('click', function() {
    localStorage.setItem('isSignedIn', 'false');
    alert('You have signed out.');
    updateSignInUI(); // Update UI after signing out
});
       
    </script>
</body>
</html>

<script>
    // Check the sign-in status on page load
    const isSignedIn = localStorage.getItem('isSignedIn');

    // Reset sign-in status when the page is being unloaded

    // Update UI based on sign-in status
    function updateSignInUI() {
        const signinLink = document.getElementById('signin-link');
        if (isSignedIn === 'true') {
            signinLink.innerHTML = '<img src="images/profile.png" alt="my profile" style="height:50px; width:50px;">';
            signinLink.href = 'profile.html'; // Change to the desired profile page
        } else {
            signinLink.textContent = 'Sign In'; // Ensure default text is displayed if not signed in
        }
    }

    // Call the function to update the UI
    updateSignInUI();
</script>